---
- |
    ## 10.18 总结

    呜呜呜，打的好烂。

- |
    ### T1 XYD 23015 币硬翻

    题目大意，有一个 $N\times N(N\le10^5)$ 的棋盘，每个格子有一枚硬币，初始时由 $K(K\le10^6)$ 个硬币反了，每次你可以同时对一个硬币翻整行整列（这枚不动），问至少要几次。

    读错题了，原题上写着 `然后将与这枚硬币在同一行或同一列的硬币全部翻面，需要注意的是，选择的这枚硬币不会翻面。`，看到 `或` 字我以为自选。

    观察到如果存在一个点 $(r,c)$ 满足 $(1,1)\oplus(r,1)\oplus(1,c)\oplus(r,c)=1$ 就无解，否则只用计数第一行和第一列的情况即可。

- |
    ### T2 XYD 23016 C树

    题意：有一颗有根树（$1$ 的父亲是虚点 $0$），每次可以进行一次篡位操作，即把 $(u,fa_u)$ 和 $(fa_u,fa_{fa_u})$ 断开，扔掉 $fa_u$ 所在连通块，连接 $(u,fa_{fa_u})$。（是不是很形象）。

    直接计数，为 $f_{u,0/1}$ 表示 $u$ 这颗子树保不保留顶点 $u$ 的所有方案，统计答案比较麻烦，没码出来。

- |
    ### T3 XYD 23017 打字机

    竟然是愚人节原题（当时 D 了题解），[指鹿为马](https://www.luogu.com.cn/problem/solution/P12602)。

    没想到可以高消可以避免循环引用。。。

    设 $f_i$ 为 $S$ 的前 $i$ 个字符成为打出串的子串的期望次数。

    显然有两种情况：

    - 下一个直接填出 $S_{i+1}$，概率为 $\frac{cnt_{s_i,s_{i+1}}}{cnt_{s_{i}}}$。
    - 填出来别的乱七八糟字符，发现此时又出现两种情况：

    >1. 是此时串的一段后缀是 $S$ 的前缀，设最大长度为 $k$ ，那么就相当于从 $k$ 开始填，期望需要 $f_{i + 1} - f_{k} + 1$ 次。
    >
    >2. 否则就重新开始填，设 $g_j$ 为从 $j$ 开始填，填出来 $S_1$ 的期望次数（包括 $j$ 本身），表示出来后随便高消。期望次数是 $g_j + f_{i+1} - 1$ 。 

    随便移项计算，随便优化一下 KMP，这些都是简单的。
